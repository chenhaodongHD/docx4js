<!DOCTYPE html>
<html>
<head>
	<script src="index.js"></script>
	<script>
		function toggle(el){
			const dd=el.parentNode.parentNode.lastChild
			if(dd){
				dd.style.display= el.innerText=="+" ? "inherit" : "none"
				el.innerText=el.innerText=="+" ? "-" : "+"
			}
		}
		function test(input){
			require("docx4js").docx
			.load(input.files[0])
			.then(function(docx){
				input.value=""
				const element=docx.render((type, props, children)=>{
					const hasChild=children && children.length
					const el=document.createElement("dl")
					el.innerHTML=`<dt><i onclick="toggle(this)">+</i><span>${type}</span></dt>`
					if(hasChild){
						el.append(document.createElement("dd"))
						children.forEach(child => {
							el.querySelector('dd').append(child)
						});
					}
					return el
				})
				
				const container=document.querySelector('#docx')
				container.lastChild && container.removeChild(container.lastChild)
				container.appendChild(element)
			})
		}
	</script>
	<style>
		i{cursor:default;display: inline-block; width: 10px;}
		dd{margin-left:20px;display: none;}
		dl{margin: auto 5px;}
	</style>
</head>
<body>
	<div>
		<input type="file" onchange="test(this)">
		<div id="docx"></div>
	</div>
</body>
</html>
